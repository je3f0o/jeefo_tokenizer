/**
 * jeefo_tokenizer : v0.0.15
 * Author          : undefined, <undefined>
 * Homepage        : https://github.com/je3f0o/jeefo_tokenizer
 * License         : The MIT license
 * Copyright       : 2017
 **/
function e(e){!function(e){var n=e.module("jeefo_core",[]),t=function(e){return function(n,t,r,i){return"function"===typeof t?(i=r,r=t,t=[]):"string"===typeof t&&(t=[t]),void 0===i&&(i=!0),e.call(this,n,{fn:r,dependencies:t,resolve_once:i})}},r=function(e){var n=function(n,t){return(t?e:"")+n.toLowerCase()};return function(){return this.replace(/[A-Z]/g,n)}};String.prototype.dash_case=r("-"),String.prototype.snake_case=r("_"),n.extend("curry",["$injector"],function(e){return t(function(n,t){e.register((n+"Curry").snake_case(),t)})}),n.curry("makeInjectable",function(){return t}),n.extend("run",["$injector"],function(e){var n=Array;return function(t,r){var i,s,o=0;if("function"===typeof t)r=t,s=[];else if("string"===typeof t)s=[e.resolve_sync(t)];else for(o=0,i=t.length,s=new n(i);o<i;++o)s[o]=e.resolve_sync(t[o]);return r.apply(this,s)}}),n.extend("namespace",["$injector","make_injectable_curry"],function(e,n){return n(function(n,t){for(var r,i,s=n.split("."),o=s.pop(),c=0,a=s.length,h="";c<a;++c)r=s[c],h&&(i=e.resolve_sync(h)),h=h?h+"."+r:r,e.has(h)||(e.register(h,{dependencies:[],resolve_once:!0,fn:function(){return{}}}),i&&(i[r]=e.resolve_sync(h)));e.register(n,t),h&&(i=e.resolve_sync(h),i[o]=e.resolve_sync(n))})}),n.extend("factory",["$injector","make_injectable_curry"],function(e,n){return n(function(n,t){e.register((n+"Factory").snake_case(),t)})}),n.extend("service",["$injector","make_injectable_curry"],function(e,n){return n(function(n,t){t.is_constructor=!0,e.register((n+"Service").snake_case(),t)})})}(e);var n=function(e){for(var n in e)this[n]=e[n]},t=n.prototype;t.error=function(e){var n=new SyntaxError(e);throw n.token=this.value,n.lineNumber=this.start.line,n.columnNumber=this.start.column,n},t.error_unexpected_type=function(){this.error("Unexpected "+this.type)},t.error_unexpected_token=function(){this.error("Unexpected token")};var r=function(e){this.type=e.type,this.name=e.name||e.type,this.start=e.start,this.end=e.end,e.skip&&(this.skip=e.skip),e.until&&(this.until=e.until),e.keepend&&(this.keepend=e.keepend),e.contains&&(this.contains=e.contains),e.contained&&(this.contained=e.contained),e.escape_char&&(this.escape_char=e.escape_char),e.contains&&(this.contains_chars=this.find_special_characters(e.contains))};t=r.prototype,t.RegionDefinition=r,t.copy=function(){return new this.RegionDefinition(this)},t.find_special_characters=function(e){for(var n=0;n<e.length;++n)if("SpecialCharacter"===e[n].type)return e[n].chars.join("")};var i=function(e){this.hash={},this.language=e,this.global_null_regions=[],this.contained_null_regions=[]};t=i.prototype,t.sort_function=function(e,n){return e.start.length-n.start.length},t.register=function(e){if(e=new r(e),e.start)this.hash[e.start[0]]?(this.hash[e.start[0]].push(e),this.hash[e.start[0]].sort(this.sort_function)):this.hash[e.start[0]]=[e];else if(e.contained)this.contained_null_regions.push(e);else{if(this.global_null_region)throw Error("Overwritten global null region.");this.global_null_region=e}},t.find=function(e,n){var t,r,i,s=0,o=this.hash[n.current()];if(e&&e.contains){if(o)e:for(s=o.length-1;s>=0;--s)for(r=e.contains.length-1;r>=0;--r)if(o[s].type===e.contains[r].type){for(i=1,t=o[s].start;i<t.length;++i)if(n.peek(n.current_index+i)!==t[i])continue e;return o[s].copy()}for(s=e.contains.length-1;s>=0;--s)for(r=this.contained_null_regions.length-1;r>=0;--r)if(this.contained_null_regions[r].type===e.contains[s].type)return this.contained_null_regions[r].copy()}else{if(o)e:for(s=o.length-1;s>=0;--s)if(!o[s].contained){for(i=1,t=o[s].start;i<t.length;++i)if(n.peek(n.current_index+i)!==t[i])continue e;return o[s].copy()}if(this.global_null_region)return this.global_null_region.copy()}};var s=function(e){this.string=e,this.current_index=0};t=s.prototype,t.peek=function(e){return this.string.charAt(e)},t.seek=function(e,n){return this.string.substring(e,e+n)},t.next=function(){return this.peek(this.current_index+=1)},t.current=function(){return this.peek(this.current_index)};var o=function(e,n){this.lines=[{number:1,index:0}],this.start={line:1,column:1},this.tokens=[],this.stack=[],this.regions=n,this.language=e};t=o.prototype,t.is_array=Array.isArray,t.parse=function(e){for(var n,t=this.streamer=new s(e),r=t.current();r;){if(this.current_region){if(this.current_region.ignore_chars&&-1!==this.current_region.ignore_chars.indexOf(r)){r=t.next();continue}if(this.region_end(this.current_region)){this.current_token=this.current_token.parent,this.current_region=this.current_region.parent,r=t.next();continue}}n=this.regions.find(this.current_region,t),n?(this.parse_region(n),n.keepend&&this.stack.push({token:this.current_token,region:n})):r<=" "?this.handle_new_line(r):r>="0"&&r<="9"?this.parse_number():-1===this.SPECIAL_CHARACTERS.indexOf(r)?this.parse_identifier():this.parse_special_character(),r=t.next()}return this.tokens},t.parse_number=function(){var e,n=this.streamer;for(this.prepare_new_token(n.current_index),e=n.next();e>="0"&&e<="9";e=n.next());this.add_token(this.make_token("Number")),this.streamer.current_index-=1},t.SPECIAL_CHARACTERS=[",",".",";",":","<",">","~","`","!","@","#","|","%","^","&","*","(",")","-","+","=","[","]","/","?",'"',"{","}","_","'","\\"].join(""),t.parse_identifier=function(){var e,n=this.streamer;for(this.prepare_new_token(n.current_index),e=n.next();e>" "&&-1===this.SPECIAL_CHARACTERS.indexOf(e);e=n.next());this.add_token(this.make_token("Identifier")),n.current_index-=1},t.parse_region=function(e){var n,t,r,i,s=this.streamer;if(this.prepare_new_token(s.current_index),e.start&&(s.current_index+=e.start.length),e.contains)return i=this.make_token(e.type,e.name),i.children=[],this.current_token?(e.parent=this.current_region,i.parent=this.current_token,this.current_token.children.push(i)):this.tokens.push(i),this.current_token=i,this.current_region=e,void(e.start&&(s.current_index-=1));for(r=s.current();r;)if(this.handle_new_line(r),r!==e.escape_char){if(e.skip&&r===e.skip[0]){for(n=1,t=!0;n<e.skip.length;++n)if(s.peek(s.current_index+n)!==e.skip[n]){t=!1;break}if(t){s.current_index+=e.skip.length,r=s.current();continue}}if(this.region_end(e,!0))return;r=s.next()}else s.current_index+=2,r=s.current()},t.parse_special_character=function(){!this.current_region||this.current_region.contains_chars&&-1!==this.current_region.contains_chars.indexOf(this.streamer.current())||(this.prepare_new_token(this.streamer.current_index),this.streamer.current_index+=1,this.make_token("SpecialCharacter").error_unexpected_token()),this.prepare_new_token(this.streamer.current_index),this.streamer.current_index+=1,this.add_token(this.make_token("SpecialCharacter")),this.streamer.current_index-=1},t.region_end=function(e,n){var t=0;if(this.is_array(e.end))for(;t<e.end.length;++t)if(this.check_end_token(e,e.end[t],n))return this.finallzie_region(e),!0;return this.check_end_token(e,e.end,n)?(this.finallzie_region(e),!0):!!this.region_end_stack(e,n)||void 0},t.finallzie_region=function(e){for(var n=0;n<this.stack.length;++n)this.stack[n].region===e&&(this.current_token=this.stack[n].token,this.current_region=this.stack[n].region,this.stack.splice(n,this.stack.length))},t.region_end_stack=function(e,n){for(var t,r=this.stack.length-1;r>=0;--r)if(this.is_array(this.stack[r].region.end)){for(t=0;t<this.stack[r].region.end.length;++t)if(this.check_end_token(e,this.stack[r].region.end[t],n))return this.finallzie_region(this.stack[r].region),!0}else if(this.check_end_token(e,this.stack[r].region.end,n))return this.finallzie_region(this.stack[r].region),!0},t.check_end_token=function(e,n,t){var r=1,i=this.streamer;if(i.current()===n[0]){for(;r<n.length;++r)if(i.peek(i.current_index+r)!==n[r])return!1;if(e.until||(i.current_index+=n.length),t){var s=this.make_token(e.type,e.name);this.set_value(s,e.start?e.start.length:0,e.until?0:n.length),this.add_token(s)}else this.set_end(this.current_token),this.set_value(this.current_token,e.start?e.start.length:0,e.until?0:n.length);return i.current_index-=1,!0}},t.handle_new_line=function(e){"\r"!==e&&"\n"!==e||this.new_line()},t.new_line=function(){this.lines.push({number:this.lines.length+1,index:this.streamer.current_index+1})},t.set_value=function(e,n,t){e.value=this.streamer.seek(e.start.index+n,e.end.index-e.start.index-n-t)},t.set_end=function(e){e.end.line=this.lines.length,e.end.column=this.streamer.current_index-this.lines[this.lines.length-1].index,e.end.index=this.streamer.current_index},t.prepare_new_token=function(e){this.start={line:this.lines.length,column:e-this.lines[this.lines.length-1].index+1,index:e}},t.add_token=function(e){this.current_token?this.current_token.children.push(e):this.tokens.push(e)},t.make_token=function(e,t){var r=this.start.index,i=this.streamer.current_index-this.start.index;return new n({type:e,name:t||e,value:this.streamer.seek(r,i),start:this.start,end:{line:this.lines.length,column:this.streamer.current_index-this.lines[this.lines.length-1].index+1,virtual_column:this.lines.column,index:this.streamer.current_index}})};var c=e.module("jeefo_tokenizer",["jeefo_core"]);c.namespace("tokenizer.Token",function(){return n}),c.namespace("tokenizer.Region",function(){return i}),c.namespace("tokenizer.TokenParser",function(){return o})}