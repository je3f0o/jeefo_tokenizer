/**
 * jeefo_tokenizer : v0.0.17
 * Author          : je3f0o, <je3f0o@gmail.com>
 * Homepage        : https://github.com/je3f0o/jeefo_tokenizer
 * License         : The MIT license
 * Copyright       : 2017
 **/
!function(e,t,n){"use strict";e.use(function(){var t=e.module("jeefo_core",[]),n=function(e){return e.replace(/[A-Z]/g,function(e,t){return(t?"-":"")+e.toLowerCase()})},r=function(e){return e.replace(/[A-Z]/g,function(e,t){return(t?"_":"")+e.toLowerCase()})},i=Object.prototype.toString,s=Function.toString,o=/^\[object .+?Constructor\]$/,c=/^function.*?\(\) \{ \[native code\] \}$/,a=function(e){return"[object Date]"===i.call(e)},h=function(e){return"[object RegExp]"===i.call(e)},u=function(e,t){return(t?/^\d+(?:.\d+)?$/:/^\-?\d+(?:.\d+)?$/).test(e)},_=function(e,t){return(t?/^\d+$/:/^\-?\d+$/).test(e)},l=function(e){var t=typeof e;return"function"===t?c.test(s.call(e)):e&&"object"===t&&o.test(i.call(e))||!1},f=function(e){try{return JSON.parse(e)}catch(e){}};t.extend("namespace",["$injector","make_injectable"],function(e,t){return function(n){for(var r,i,s=n.split("."),o=s.pop(),c=0,a="";c<s.length;++c)r=s[c],a&&(i=e.resolve_sync(a)),a=a?a+"."+r:r,e.has(a)||(e.register(a,{fn:function(){return{}}}),i&&(i[r]=e.resolve_sync(a)));return e.register(n,t.apply(null,arguments)),a&&(i=e.resolve_sync(a),i[o]=e.resolve_sync(n)),this}}).namespace("transform.dash_case",function(){return n}).namespace("transform.snake_case",function(){return r}).extend("curry",["$injector","make_injectable","transform.snake_case"],function(e,t,n){return function(r){return e.register(n(r+"Curry"),t.apply(null,arguments)),this}}).extend("run",["$injector","$q","Array"],function(e,t,n){var r=this;return function(i,s){if("function"===typeof i)i.call(this);else if("string"===typeof i)e.resolve(i).then(function(e){s.call(r,e)});else{var o=new n(i.length);t.for_each_async(i,function(t,n,r){e.resolve(t).then(function(e){o[n]=e,r()})}).then(function(){s.apply(r,o)})}return this}}).extend("factory",["$injector","make_injectable","transform.snake_case"],function(e,t,n){return function(r){return e.register(n(r+"Factory"),t.apply(null,arguments)),this}}).extend("service",["$injector","make_injectable","transform.snake_case"],function(e,t,n){return function(r){var i=t.apply(null,arguments);return i.is_constructor=!0,e.register(n(r+"Service"),i),this}}).run("$injector",function(e){e.register("is_date",{fn:function(){return a}}).register("is_regex",{fn:function(){return h}}).register("is_digit",{fn:function(){return u}}).register("is_digit_int",{fn:function(){return _}}).register("is_native",{fn:function(){return l}}).register("json_parse",{fn:function(){return f}})})}),e.use(function(){var t=function(){};t.prototype={error:function(e){var t=new SyntaxError(e);throw t.value=this.value,t.lineNumber=this.start.line,t.columnNumber=this.start.column,t},error_unexpected_type:function(){this.error("Unexpected "+this.type)},error_unexpected_token:function(){this.error("Unexpected token")}};var n=function(e){this.type=e.type,this.name=e.name||e.type,this.start=e.start,this.end=e.end,e.skip&&(this.skip=e.skip),e.until&&(this.until=e.until),e.keepend&&(this.keepend=e.keepend),e.contains&&(this.contains=e.contains),e.contained&&(this.contained=e.contained),e.escape_char&&(this.escape_char=e.escape_char),e.contains&&(this.contains_chars=this.find_special_characters(e.contains))};n.prototype={copy:function(){return new this.constructor(this)},find_special_characters:function(e){for(var t=e.length-1;t>=0;--t)if("SpecialCharacter"===e[t].type)return e[t].chars.join("")}};var r=function(e){this.hash={},this.language=e,this.global_null_regions=[],this.contained_null_regions=[]};r.prototype={RegionDefinition:n,sort_function:function(e,t){return e.start.length-t.start.length},register:function(e){if(e=new this.RegionDefinition(e),e.start)this.hash[e.start[0]]?(this.hash[e.start[0]].push(e),this.hash[e.start[0]].sort(this.sort_function)):this.hash[e.start[0]]=[e];else if(e.contained)this.contained_null_regions.push(e);else{if(this.global_null_region)throw Error("Overwritten global null region.");this.global_null_region=e}},find:function(e,t){var n,r,i,s=0,o=this.hash[t.current()];if(e&&e.contains){if(o)e:for(s=o.length-1;s>=0;--s)for(r=e.contains.length-1;r>=0;--r)if(o[s].type===e.contains[r].type){for(n=o[s].start,i=n.length-1;i>=1;--i)if(t.peek(t.current_index+i)!==n.charAt(i))continue e;return o[s].copy()}for(s=e.contains.length-1;s>=0;--s)for(r=this.contained_null_regions.length-1;r>=0;--r)if(this.contained_null_regions[r].type===e.contains[s].type)return this.contained_null_regions[r].copy()}else{if(o)e:for(s=o.length-1;s>=0;--s)if(!o[s].contained){for(n=o[s].start,i=n.length-1;i>=1;--i)if(t.peek(t.current_index+i)!==n.charAt(i))continue e;return o[s].copy()}if(this.global_null_region)return this.global_null_region.copy()}}};var i=function(e){this.string=e,this.current_index=0};i.prototype={peek:function(e){return this.string.charAt(e)},seek:function(e,t){return this.string.substring(e,e+t)},next:function(){return this.peek(++this.current_index)},current:function(){return this.peek(this.current_index)}};var s=function(e,t){this.lines=[{number:1,index:0}],this.start={line:1,column:1},this.tokens=[],this.stack=[],this.regions=t,this.language=e};s.prototype={is_array:Array.isArray,parse:function(e){for(var t,n=this.streamer=new i(e),r=n.current();r;){if(this.current_region){if(this.current_region.ignore_chars&&-1!==this.current_region.ignore_chars.indexOf(r)){r=n.next();continue}if(this.region_end(this.current_region)){this.current_token=this.current_token.parent,this.current_region=this.current_region.parent,r=n.next();continue}}t=this.regions.find(this.current_region,n),t?(this.parse_region(t),t.keepend&&this.stack.push({token:this.current_token,region:t})):r<=" "?this.handle_new_line(r):r>="0"&&r<="9"?this.parse_number():-1===this.SPECIAL_CHARACTERS.indexOf(r)?this.parse_identifier():this.parse_special_character(),r=n.next()}return this.tokens},parse_number:function(){var e,t=this.streamer;for(this.prepare_new_token(t.current_index),e=t.next();e>="0"&&e<="9";e=t.next());this.add_token(this.make_token("Number")),this.streamer.current_index-=1},SPECIAL_CHARACTERS:[",",".",";",":","<",">","~","`","!","@","#","|","%","^","&","*","(",")","-","+","=","[","]","/","?",'"',"{","}","_","'","\\"].join(""),parse_identifier:function(){var e,t=this.streamer;for(this.prepare_new_token(t.current_index),e=t.next();e>" "&&-1===this.SPECIAL_CHARACTERS.indexOf(e);e=t.next());this.add_token(this.make_token("Identifier")),t.current_index-=1},parse_region:function(e){var t,n,r,i,s=this.streamer;if(this.prepare_new_token(s.current_index),e.start&&(s.current_index+=e.start.length),e.contains)return i=this.make_token(e.type,e.name),i.children=[],this.current_token?(e.parent=this.current_region,i.parent=this.current_token,this.current_token.children.push(i)):this.tokens.push(i),this.current_token=i,this.current_region=e,void(e.start&&(s.current_index-=1));for(r=s.current();r;)if(this.handle_new_line(r),r!==e.escape_char){if(e.skip&&r===e.skip.charAt(0)){for(t=1,n=!0;t<e.skip.length;++t)if(s.peek(s.current_index+t)!==e.skip.charAt(t)){n=!1;break}if(n){s.current_index+=e.skip.length,r=s.current();continue}}if(this.region_end(e,!0))return;r=s.next()}else s.current_index+=2,r=s.current()},parse_special_character:function(){!this.current_region||this.current_region.contains_chars&&-1!==this.current_region.contains_chars.indexOf(this.streamer.current())||(this.prepare_new_token(this.streamer.current_index),this.streamer.current_index+=1,this.make_token("SpecialCharacter").error_unexpected_token()),this.prepare_new_token(this.streamer.current_index),this.streamer.current_index+=1,this.add_token(this.make_token("SpecialCharacter")),this.streamer.current_index-=1},region_end:function(e,t){var n=0;if(this.is_array(e.end))for(;n<e.end.length;++n)if(this.check_end_token(e,e.end[n],t))return this.finallzie_region(e),!0;return this.check_end_token(e,e.end,t)?(this.finallzie_region(e),!0):!!this.region_end_stack(e,t)||void 0},finallzie_region:function(e){for(var t=0;t<this.stack.length;++t)this.stack[t].region===e&&(this.current_token=this.stack[t].token,this.current_region=this.stack[t].region,this.stack.splice(t,this.stack.length))},region_end_stack:function(e,t){for(var n,r=this.stack.length-1;r>=0;--r)if(this.is_array(this.stack[r].region.end)){for(n=0;n<this.stack[r].region.end.length;++n)if(this.check_end_token(e,this.stack[r].region.end[n],t))return this.finallzie_region(this.stack[r].region),!0}else if(this.check_end_token(e,this.stack[r].region.end,t))return this.finallzie_region(this.stack[r].region),!0},check_end_token:function(e,t,n){var r=1,i=this.streamer;if(i.current()===t.charAt(0)){for(;r<t.length;++r)if(i.peek(i.current_index+r)!==t.charAt(r))return!1;if(e.until||(i.current_index+=t.length),n){var s=this.make_token(e.type,e.name);this.set_value(s,e.start?e.start.length:0,e.until?0:t.length),this.add_token(s)}else this.set_end(this.current_token),this.set_value(this.current_token,e.start?e.start.length:0,e.until?0:t.length);return i.current_index-=1,!0}},handle_new_line:function(e){"\r"!==e&&"\n"!==e||this.new_line()},new_line:function(){this.lines.push({number:this.lines.length+1,index:this.streamer.current_index+1})},set_value:function(e,t,n){e.value=this.streamer.seek(e.start.index+t,e.end.index-e.start.index-t-n)},set_end:function(e){e.end.line=this.lines.length,e.end.column=this.streamer.current_index-this.lines[this.lines.length-1].index,e.end.index=this.streamer.current_index},prepare_new_token:function(e){this.start={line:this.lines.length,column:e-this.lines[this.lines.length-1].index+1,index:e}},add_token:function(e){this.current_token?this.current_token.children.push(e):this.tokens.push(e)},make_token:function(e,n){var r=this.start.index,i=this.streamer.current_index-this.start.index,s=new t;s.type=e,s.name=n||e,s.value=this.streamer.seek(r,i),s.start=this.start,s.end={line:this.lines.length,column:this.streamer.current_index-this.lines[this.lines.length-1].index+1,virtual_column:this.lines.column,index:this.streamer.current_index}}},e.module("jeefo_tokenizer",["jeefo_core"]).namespace("tokenizer.Token",function(){return t}).namespace("tokenizer.Region",function(){return r}).namespace("tokenizer.TokenParser",function(){return s})})}(window.jeefo,window,document);